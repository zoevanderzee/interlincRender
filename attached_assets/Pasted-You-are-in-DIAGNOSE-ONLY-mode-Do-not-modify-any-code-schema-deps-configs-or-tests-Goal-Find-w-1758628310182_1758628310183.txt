You are in DIAGNOSE-ONLY mode. Do not modify any code, schema, deps, configs, or tests.
Goal: Find why contractor submissions don’t appear to the business due to work_request_id mismatch/regression.
Steps (output all findings, then stop):
Trace the ID across the flow (read-only):
List every file/function/endpoint/event where work_request_id (or synonyms: request_id, workId, job_id, etc.) is created, transformed, stored, or queried.
For each hop, show: source field → target field, type (string/uuid/int), and any mapping/serialization logic.
DB checks (read-only):
Show table/collection names and schemas for business “requests” and contractor “submissions”.
Confirm the exact key used to join them (e.g., submissions.work_request_id → requests.id).
Run counts:
“orphan submissions” (submissions with work_request_id not found in requests).
“orphan requests” (requests with no submissions).
Show 5 sample rows for each orphan case (ids only, no PII).
Type/shape & casing:
Report whether work_request_id is stored as UUID vs string vs int in each layer (API payloads, DB, client state). Check for hyphen stripping, case normalization, leading/trailing spaces.
Filters/visibility:
List all business-side query filters (status/tenant/owner/role). Show the exact WHERE/filters used when viewing submissions. Confirm that a valid submission would pass those filters.
Environment/tenant scoping:
Confirm env/tenant/project IDs used for the contractor vs business reads/writes (are they the same?). Surface any .env/header/namespace differences (read-only).
Recent diffs (read-only):
Show any changes since the last known good commit that touch: routing/DTOs/serializers, DB schema, auth middleware, “work request” list/query, submission create handlers, and feature flags.
Minimal fix proposal (DO NOT APPLY):
If you find the regression, propose one minimal change (1–3 lines) to restore old behavior (e.g., consistent field name, join key, query filter). Include the single file path and exact line(s) to edit.
Stop after output. Do not auto-fix. Wait for my explicit “APPROVE FIX”.